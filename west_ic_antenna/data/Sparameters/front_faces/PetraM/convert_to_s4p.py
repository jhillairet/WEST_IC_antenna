# -*- coding: utf-8 -*-
"""
Transform the data from Matthew Poulos to skrf Network 
and save the data to a .s4p

also renumber the ports from


to :
    

@author: JH218595
"""
import numpy as np
import skrf as rf

freqs = 44, 46, 48, 50, 52, 54, 56, 64

s = np.array([
[[0.10306623382976188+0.9362827693505921j,
-0.0033077697136587947+0.001207223864262811j,
-0.00901448467051647+0.0010342433732492009j,
0.0011238060301676674-0.0004686267744629394j],
[-0.0038791456392482126+0.0006122519620864837j,
0.09940932941799516+0.9371526856173245j,
3.311151983388873e-05-0.00028803149144998553j,
-0.008653072256978537+0.0005245331077326936j],
[-0.008807137836337292+0.0010868415483368226j,
-0.0002722894025221511-0.0005202037254689065j,
0.1002602148124282+0.9364247463007395j,
-0.0033792566985963025+0.001222675696078806j],
[0.0009967994056500013-0.00014542129544378116j,
-0.008480008347233708+0.0005863683943201266j,
-0.003926970943646781+0.0005584146540703849j,
0.10203037148246516+0.9369606926276788j]], 
     [[0.03548604748379209+0.9360201088632061j,
-0.0033524050985618056+0.0005849128906480319j,
 -0.00936460367705241+1.9492200035470805e-05j,
0.0006951076610323441-2.6564926142897465e-05j],
[-0.0039012514569133445+0.00021988990298935107j,
0.03176637968540171+0.9365214455145403j,
-0.0004722150093736199-6.737235382193695e-05j,
-0.009040340248629338-0.0003871628471940302j],
[-0.009152446838907249+0.00014836299555654866j,
-0.0010040887576918624-0.00017473469196050548j,
0.032617549613970266+0.9358622953259773j,
-0.0033820241144343604+0.0005756149375179742j],
[0.0008370835413790198+7.124309818854754e-05j,
-0.008884040388421346-0.0003006944831304127j,
-0.0039020872109352014+0.0002131177615816217j,
0.03436898642367637+0.9365881971039101j]],
     [[-0.03205308721841798+0.9302195435372731j,
-0.0036406135750581643+0.0004600274862158804j,
-0.01001029179980915-0.0006316445715763025j,
0.0008541828393849073-0.0002491663432146605j],
[-0.0041312257684202715-6.525743775220565e-05j,
-0.035952752460549374+0.9305901648750191j,
-0.0003600449784243366-0.0003113755529545523j,
-0.009603854603296557-0.0010903482890787203j],
[-0.00981830591134959-0.0005069465325308464j,
-0.0007834277764057564-0.0006345454765289362j,
-0.0349356215865685+0.929946218361455j,
-0.0036756040725921353+0.0004779129919494514j],
[0.0008950424280516555-1.7939382923829312e-05j,
-0.009450217823860135-0.0010021610727370279j,
-0.004151714514241797-4.906677640058192e-05j,
-0.03329966064159599+0.9307418879559434j]],
     [[-0.09922825500116397+0.9194308429229794j,
-0.003806143824741715-2.5894370894704014e-05j,
-0.010552877138398814-0.0017752693715757332j,
0.0010228279605812636+9.485658381916962e-05j],
[-0.004245698080472457-0.0004882276056610946j,
-0.10338323999490796+0.9195168587716811j,
-0.0003234622869914084-0.00017190775392005066j,
-0.010071206713857153-0.002186220484661762j],
[-0.010358911586178025-0.0015910470680656958j,
-0.0007380870013331697-0.0003672032859388213j,
-0.10225759990420434+0.9189791918398243j,
-0.0038721864569115968-2.5088385603363873e-05j],
[0.0010653428256420887+0.00016398231030704624j,
-0.009920297245547076-0.0020602097514950605j,
-0.004295054194378783-0.0004855180560759876j,
-0.10060142177657524+0.9198813294225298j]],
     [[-0.1657553644509124+0.9033061109431264j,
-0.0038818435397758896-0.00020802275956712148j,
-0.010835328768341776-0.0026853027378182766j,
0.000856779524074514+3.399758986209127e-05j],
[-0.0043562340858039-0.0008289483308629296j,
-0.17006957114267332+0.9030217144009475j,
-0.0003868365357267479-0.0003270441233105128j,
-0.010278755282567508-0.0031619975399619416j],
[-0.010689068067783707-0.0025056557900391264j,
-0.000871298889192824-0.0007752370719971486j,
-0.16877095803699768+0.902546772497637j,
-0.003974885979325136-0.00021713053758058132j],
[0.0009657124052357103+0.00026713790929336947j,
-0.010149644074467092-0.0030389924901156043j,
-0.004416648944113895-0.0008715482518309309j,
-0.16729274045414103+0.9036625038363473j]],
     [[-0.2310718410382077+0.8820043739968823j,
-0.004093960124234218-0.0006200526148463913j,
-0.011343720574743305-0.00380507852839363j,
0.0012076544278002339+3.084717397920491e-05j],
[-0.004443455444908074-0.0012566468770991125j,
-0.23547547483796424+0.8813531198707243j,
-0.00023075080632371545-0.0003538587625655057j,
-0.010570792158330594-0.004270921123173072j],
[-0.011172157789000195-0.0036138439937617194j,
-0.00047002494816276525-0.000778364995629136j,
-0.2340239335746556+0.8810826010702554j,
-0.004226161586926116-0.0007078803042590007j],
[0.0011546986590566055+0.0002433588545568736j,
-0.010438673509026941-0.00412053628808381j,
-0.004469174108401341-0.0013422735612400026j,
-0.23273266174662932+0.8821995621215281j]],
     [[-0.2948260805818151+0.8554721446445313j,
-0.004130405281188439-0.0009319792373357285j,
-0.011515690327910088-0.00518609391682273j,
0.0012296652693744138+0.0004081614221741193j],
[-0.004517120588551889-0.0016942286825343818j,
-0.2993051137408766+0.854371901527771j,
-0.0001867075342564552-0.00030084708892288335j,
-0.010572970648598847-0.005499479784349751j],
[-0.011373022136665373-0.004979395426629645j,
-0.0005352724486872493-0.0007256476021705949j,
-0.29779912372875816+0.854322095395929j,
-0.004192827588292094-0.001123964515874762j],
[0.001242643164079918+0.0005869968923126671j,
-0.010473527893140029-0.005363656941458679j,
-0.004479846073671697-0.001785930422716868j,
-0.29662187806791745+0.8555213595473691j]],
     [[-0.5252121854452944+0.6997681177545608j,
-0.0039394710873457105-0.0029275591544705476j,
-0.01038405040617585-0.01095708106340377j,
0.0008491513405692433+0.001034687804889071j],
[-0.0037358328298869-0.0035862143040688707j,
-0.5291050648278515+0.6969645167337252j,
-0.00026590126073295636+9.483491547973723e-05j,
-0.009386605873037844-0.010457395437579736j],
[-0.01035140658376791-0.01054907952578932j,
-0.0005116494908328424-0.0005369661364062307j,
-0.5279365678098452+0.6976438682905035j,
-0.0036098732175834218-0.002981148168492409j],
[0.0009803917266615497+0.0013812995949215557j,
-0.009284295781431025-0.010136129335480276j,
-0.00358683478046693-0.0036300600289364006j,
-0.527141891342112+0.6985804046048265j]]
     ])

freqs = rf.Frequency.from_f(freqs, unit='MHz')
ntw = rf.Network(frequency=freqs)
ntw.s = s

# define z0
ntw.z0 = 46.6

# export .s4p
ntw.write_touchstone('WEST_ICRH_plasma_PetraM.s4p', write_z0=True)

    

